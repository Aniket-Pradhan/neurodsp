<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Simulating Signals &#8212; neurodsp 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          neurodsp</a>
        <span class="navbar-text navbar-version pull-left"><b>2.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="https://github.com/neurodsp-tools/neurodsp">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-7-simulatingsignals-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="simulating-signals">
<span id="sphx-glr-auto-tutorials-plot-7-simulatingsignals-py"></span><h1>Simulating Signals<a class="headerlink" href="#simulating-signals" title="Permalink to this headline">¶</a></h1>
<p>Simulate periodic (oscillatory) and aperiodic (1/f-like) signals.</p>
<p>This tutorial primarily covers <code class="xref py py-mod docutils literal notranslate"><span class="pre">neurodsp.sim</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">neurodsp</span> <span class="kn">import</span> <span class="n">spectral</span><span class="p">,</span> <span class="n">sim</span>

<span class="kn">from</span> <span class="nn">neurodsp.plts.spectral</span> <span class="kn">import</span> <span class="n">plot_power_spectra</span>
<span class="kn">from</span> <span class="nn">neurodsp.plts.time_series</span> <span class="kn">import</span> <span class="n">plot_time_series</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the random seed, for consistency simulating data</span>
<a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.random.html#numpy.random.seed" title="View documentation for numpy.random.seed"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="simulate-brown-noise">
<h2>Simulate brown noise<a class="headerlink" href="#simulate-brown-noise" title="Permalink to this headline">¶</a></h2>
<p>Often, we want to simulate noise that is comparable to what we see in neural recordings.</p>
<p>Brown noise is a good proxy for that because, like neural signals,
power decreases roughly linearly with frequency.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate brown noise</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">exponent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">br_noise</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_powerlaw</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">br_noise</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_001.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">br_noise</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">plot_power_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_002.png" />
</div>
<div class="section" id="simulate-filtered-brown-noise">
<h2>Simulate filtered brown noise<a class="headerlink" href="#simulate-filtered-brown-noise" title="Permalink to this headline">¶</a></h2>
<p>However, brown noise has a lot of power in very slow frequnecies,
whereas these slow frequencies are often not present or filtered out
in neural signals. Therefore, we may desire our brown noise to be
high-pass filtered. See that the resulting signal has much less
low-frequency drift.</p>
<p>Note this might not be ideal because it creates an “oscillation” at
the cutoff frequency.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate highpass-filtered brown noise with a 1Hz cutoff frequency</span>
<span class="n">f_hipass_brown</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">brown_filt</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_powerlaw</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">exponent</span><span class="p">,</span> <span class="n">f_range</span><span class="o">=</span><span class="p">(</span><span class="n">f_hipass_brown</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Transition bandwidth is 1.0 Hz.
Pass/stop bandwidth is 499.0 Hz.
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">brown_filt</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_003.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">brown_filt</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">plot_power_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_004.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_004.png" />
<p>Note: the <code class="xref py py-func docutils literal notranslate"><span class="pre">sim_variable_powerlaw()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">sim_filtered_noise()</span></code> functions can
support arbitrary power law exponents, such as pink noise (-1).</p>
</div>
<div class="section" id="other-1-f-like-noises">
<h2>Other 1/f-like noises<a class="headerlink" href="#other-1-f-like-noises" title="Permalink to this headline">¶</a></h2>
<p>We can also simulate an Ornstein-Uhlenbeck process (random walk with memory),
as well as ‘synaptic (Lorentzian) noise’, which is white noise convolved
with an exponentially-decaying kernel mimicking the shape of a post-synaptic
potential.</p>
<p>Both of these noise models produce 1/f scaling in higher frequencies with a
fixed exponent of -2. For more details on their usage in simulating neural
signals, please see Destexhe et al., 2001 and Gao et al., 2017.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate aperiodic signals from OU process &amp; synaptic noise model</span>
<span class="n">ou_noise</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_random_walk</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">syn_noise</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_synaptic_current</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">ou_noise</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;OU Process&#39;</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">syn_noise</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Synaptic Noise&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_plot_7-SimulatingSignals_005.png" class="sphx-glr-multi-img first" src="../_images/sphx_glr_plot_7-SimulatingSignals_005.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_7-SimulatingSignals_006.png" class="sphx-glr-multi-img first" src="../_images/sphx_glr_plot_7-SimulatingSignals_006.png" />
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">ou_psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">ou_noise</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">syn_psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">syn_noise</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">plot_power_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><span class="n">ou_psd</span><span class="p">,</span> <span class="n">syn_psd</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;OU&#39;</span><span class="p">,</span> <span class="s1">&#39;Synaptic&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_007.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_007.png" />
</div>
<div class="section" id="simulate-a-stationary-oscillator">
<h2>Simulate a stationary oscillator<a class="headerlink" href="#simulate-a-stationary-oscillator" title="Permalink to this headline">¶</a></h2>
<p>In addition to noise, you may also want to simulate an oscillatory process.
We can do that with neurodsp, with arbitrary rise-decay symmetry.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate symmetric oscillator</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">osc_freq</span> <span class="o">=</span> <span class="mf">6.6</span>
<span class="n">osc_a</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_oscillation</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span> <span class="n">cycle</span><span class="o">=</span><span class="s1">&#39;asine&#39;</span><span class="p">,</span> <span class="n">rdsym</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">osc_b</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_oscillation</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span> <span class="n">cycle</span><span class="o">=</span><span class="s1">&#39;asine&#39;</span><span class="p">,</span> <span class="n">rdsym</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># HACK: REMOVE WHEN SIM UPDATED</span>
<span class="n">osc_a</span> <span class="o">=</span> <span class="n">osc_a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_seconds</span><span class="o">*</span><span class="n">fs</span><span class="p">]</span>
<span class="n">osc_b</span> <span class="o">=</span> <span class="n">osc_b</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_seconds</span><span class="o">*</span><span class="n">fs</span><span class="p">]</span>

<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="p">[</span><span class="n">osc_a</span><span class="p">,</span> <span class="n">osc_b</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;rdsym=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;rdsym=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_008.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_008.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs_a</span><span class="p">,</span> <span class="n">psd_a</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">osc_a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">freqs_b</span><span class="p">,</span> <span class="n">psd_b</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">osc_b</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>

<span class="n">plot_power_spectra</span><span class="p">([</span><span class="n">freqs_a</span><span class="p">,</span> <span class="n">freqs_b</span><span class="p">],</span> <span class="p">[</span><span class="n">psd_a</span><span class="p">,</span> <span class="n">psd_b</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_009.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_009.png" />
<p>Notice the strong harmonics resulting from the non-sinusoidal nature of
the red oscillation.</p>
</div>
<div class="section" id="simulate-a-noisy-oscillator">
<h2>Simulate a noisy oscillator<a class="headerlink" href="#simulate-a-noisy-oscillator" title="Permalink to this headline">¶</a></h2>
<p>In order to simulate a signal that looks more like a brain signal,
you may want to simulate both an oscillation and noise. We also do this
with neurodsp bycan combining all of the above, with control over the
power ratio between oscillation and noise.</p>
<p>You can use any of the above noise models to generate the background
noise by passing in its name (str argument) and the required model
parameters as a dictionary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for simulation</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sim_synaptic_current&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_neurons&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;firing_rate&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;t_ker&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span>
                                        <span class="s1">&#39;tau_r&#39;</span><span class="p">:</span><span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;tau_d&#39;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">},</span>
              <span class="s1">&#39;sim_oscillation&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;freq&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate an oscillation over an aperiodic component &amp; associated times vector</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">combined</span><span class="o">.</span><span class="n">sim_combined</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">samps_plot</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">samps_plot</span><span class="p">],</span> <span class="n">signal</span><span class="p">[</span><span class="n">samps_plot</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">times</span><span class="p">[</span><span class="n">samps_plot</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_010.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_010.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">plot_power_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_011.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_011.png" />
</div>
<div class="section" id="simulate-a-bursting-oscillation">
<h2>Simulate a Bursting Oscillation<a class="headerlink" href="#simulate-a-bursting-oscillation" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we want to study oscillations that come and go, so it can be
useful to simulate oscillations with this property. We can do this by
controlling the probability that a burst will start or stop with each new cycle.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for simulation</span>
<span class="n">osc_freq</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">enter_burst</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
<span class="n">leave_burst</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>

<span class="c1"># Simulate a bursty oscillation</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_bursty_oscillation</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span>
                                 <span class="n">enter_burst</span><span class="o">=</span><span class="n">enter_burst</span><span class="p">,</span>
                                 <span class="n">leave_burst</span><span class="o">=</span><span class="n">leave_burst</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">osc</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_012.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_012.png" />
<p>We can shorten burst duration by increasing the probability to leave bursts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate a bursty oscillation, with a specified burst probability</span>
<span class="n">leave_burst</span> <span class="o">=</span> <span class="o">.</span><span class="mi">4</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_bursty_oscillation</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span>
                                 <span class="n">enter_burst</span><span class="o">=</span><span class="n">enter_burst</span><span class="p">,</span>
                                 <span class="n">leave_burst</span><span class="o">=</span><span class="n">leave_burst</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">osc</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_013.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_013.png" />
<p>We can increase the number of bursts by increasing the probability to enter a burst.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate a bursty oscillation, with a specified burst probability</span>
<span class="n">enter_burst</span> <span class="o">=</span> <span class="o">.</span><span class="mi">4</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_bursty_oscillation</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span>
                                 <span class="n">enter_burst</span><span class="o">=</span><span class="n">enter_burst</span><span class="p">,</span>
                                 <span class="n">leave_burst</span><span class="o">=</span><span class="n">leave_burst</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">osc</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_014.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_014.png" />
<p>We can also control the variance in amplitude, period, and rise-decay
symmetry across cycles and bursts</p>
<p>This is done in the <cite>cycle_features</cite> argument, which is a dictionary
that can take the following keys:
* amp_mean: mean cycle amplitude
* amp_std: standard deviation of cycle amplitude
* amp_burst_std: std. of mean amplitude for each burst
* period_mean: mean period (computed from <cite>freq</cite>)
* period_std: standard deviation of period (samples)
* period_burst_std: standard deviation of mean period for each burst
* rdsym_mean: mean rise-decay symmetry
* rdsym_std: standard deviation of rdsym
* rdsym_burst_std: standard deviation of mean rdsym for each burst</p>
<p>See the source code for the defaults used.</p>
<p>For example, we can increase the variability in amplitude by increasing
<cite>amp_std</cite> (default = .1)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate a bursty oscillation, with specified cycle features</span>
<span class="n">cycle_features</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;amp_std&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">}</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sim_bursty_oscillation_features</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">osc_freq</span><span class="p">,</span>
                                          <span class="n">enter_burst</span><span class="o">=</span><span class="n">enter_burst</span><span class="p">,</span>
                                          <span class="n">leave_burst</span><span class="o">=</span><span class="n">leave_burst</span><span class="p">,</span>
                                          <span class="n">cycle_features</span><span class="o">=</span><span class="n">cycle_features</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">osc</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_015.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_015.png" />
<p>As with the stationary oscillator, we can also simulate a bursting
oscillator with brown noise.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for simulation</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sim_synaptic_current&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_neurons&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;firing_rate&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                                        <span class="s1">&#39;t_ker&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tau_r&#39;</span><span class="p">:</span><span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;tau_d&#39;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">},</span>
              <span class="s1">&#39;sim_bursty_oscillation&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;freq&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate a bursty oscillation combined with aperiodic activity</span>
<span class="n">times</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">combined</span><span class="o">.</span><span class="n">sim_combined</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the time domain</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">osc</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_seconds</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_016.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_016.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the simulated data, in the frequency domain</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">osc</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">plot_power_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_7-SimulatingSignals_017.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_7-SimulatingSignals_017.png" />
<p>Sphinx settings:
sphinx_gallery_thumbnail_number = 15</p>
<p><strong>Total running time of the script:</strong> ( 0 minutes  1.538 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-7-simulatingsignals-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/b52349e2ed4ed17a9944d2416e40393d/plot_7-SimulatingSignals.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_7-SimulatingSignals.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/74df999c01e8d8e06c0a2421c9d72f31/plot_7-SimulatingSignals.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_7-SimulatingSignals.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018 - VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>